


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Uncertain Inputs with Gaussian Processes">
      
      
        <link rel="canonical" href="https://jejjohnson.github.io/uncertain_gps/MonteCarlo/demo/">
      
      
        <meta name="author" content="J. Emmanuel Johnson">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.4">
    
    
      
        <title>MCMC eGP - Uncertain Gaussian Processes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.c4007cdc.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.8435c73a.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=source+code+pro:300,400,400i,700%7Csource+code+pro&display=fallback">
        <style>body,input{font-family:"source code pro",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"source code pro",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="gray">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mcmc-egp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://jejjohnson.github.io/uncertain_gps" title="Uncertain Gaussian Processes" class="md-header-nav__button md-logo" aria-label="Uncertain Gaussian Processes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Uncertain Gaussian Processes
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              MCMC eGP
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/jejjohnson/uncertain_gps/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jejjohnson/uncertain_gps
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://jejjohnson.github.io/uncertain_gps" title="Uncertain Gaussian Processes" class="md-nav__button md-logo" aria-label="Uncertain Gaussian Processes">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Uncertain Gaussian Processes
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/jejjohnson/uncertain_gps/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jejjohnson/uncertain_gps
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Input Uncertainty for Gaussian Processes" class="md-nav__link">
      Input Uncertainty for Gaussian Processes
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      MonteCarlo
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="MonteCarlo" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        MonteCarlo
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        MCMC eGP
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="MCMC eGP" class="md-nav__link md-nav__link--active">
      MCMC eGP
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#experiment" class="md-nav__link">
    Experiment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gp-model" class="md-nav__link">
    GP Model
  </a>
  
    <nav class="md-nav" aria-label="GP Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#experiment_1" class="md-nav__link">
    Experiment
  </a>
  
    <nav class="md-nav" aria-label="Experiment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predictions" class="md-nav__link">
    Predictions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gp-model-uncertain-inputs" class="md-nav__link">
    GP Model - Uncertain Inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    Results
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Notes
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Notes" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/approximate/" title="Gaussian Approximations" class="md-nav__link">
      Gaussian Approximations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/error_propagation/" title="Error Propagation" class="md-nav__link">
      Error Propagation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/extrapolation/" title="Extrapolation" class="md-nav__link">
      Extrapolation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/literature/" title="Literature" class="md-nav__link">
      Literature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/mm/" title="Moment-Matching" class="md-nav__link">
      Moment-Matching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/next/" title="Next Steps" class="md-nav__link">
      Next Steps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/software/" title="Software" class="md-nav__link">
      Software
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/stochastic/" title="Stochastic" class="md-nav__link">
      Stochastic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/taylor/" title="Linearization (Taylor Expansions)" class="md-nav__link">
      Linearization (Taylor Expansions)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/uncertainty/" title="What is Uncertainty?" class="md-nav__link">
      What is Uncertainty?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Notes/vi/" title="Uncertain Inputs GPs - Variational Strategies" class="md-nav__link">
      Uncertain Inputs GPs - Variational Strategies
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Taylor
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Taylor" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Taylor
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Taylor/2.0_linearized_gp/" title="2.0 linearized gp" class="md-nav__link">
      2.0 linearized gp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Taylor/error_propagation/" title="Error Propagation" class="md-nav__link">
      Error Propagation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Taylor/scratch/" title="Scratch" class="md-nav__link">
      Scratch
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Taylor/taylor/" title="Linearized GP" class="md-nav__link">
      Linearized GP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Notebooks
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Notebooks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/1.0_gp_basics/" title="1.0 gp basics" class="md-nav__link">
      1.0 gp basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/1.1_gp_refactored/" title="1.1 gp refactored" class="md-nav__link">
      1.1 gp refactored
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/2.0_linearized_gp/" title="2.0 linearized gp" class="md-nav__link">
      2.0 linearized gp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/3.0_unscented_gp/" title="3.0 unscented gp" class="md-nav__link">
      3.0 unscented gp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4.0_mcmc_gp/" title="4.0 mcmc gp" class="md-nav__link">
      4.0 mcmc gp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/distances/" title="Distances" class="md-nav__link">
      Distances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/egp_pyro_svgp/" title="Egp pyro svgp" class="md-nav__link">
      Egp pyro svgp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/egp_pyro_vgp/" title="Egp pyro vgp" class="md-nav__link">
      Egp pyro vgp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/kernel_derivatives/" title="Kernel derivatives" class="md-nav__link">
      Kernel derivatives
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/numpyro_egp_mcmc/" title="Numpyro egp mcmc" class="md-nav__link">
      Numpyro egp mcmc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Talks
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Talks" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Talks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../talks/2020_kermes/" title="KERMES Meetup 2020" class="md-nav__link">
      KERMES Meetup 2020
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#experiment" class="md-nav__link">
    Experiment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gp-model" class="md-nav__link">
    GP Model
  </a>
  
    <nav class="md-nav" aria-label="GP Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#experiment_1" class="md-nav__link">
    Experiment
  </a>
  
    <nav class="md-nav" aria-label="Experiment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#predictions" class="md-nav__link">
    Predictions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gp-model-uncertain-inputs" class="md-nav__link">
    GP Model - Uncertain Inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#results" class="md-nav__link">
    Results
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jejjohnson/uncertain_gps/edit/master/docs/MonteCarlo/demo.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="mcmc-egp">MCMC eGP<a class="headerlink" href="#mcmc-egp" title="Permanent link">&para;</a></h1>
<div class="admonition abstract">
<p class="admonition-title">TLDR</p>
<p>I did a quick experiment where I look at how we can impact the error bars when doing a fully Bayesian GP (i.e. GP with MCMC inference). I have 3 cases where I use no prior on the inputs, where I use a modest prior on the inputs, and one where I use the exact known prior on the inputs. The results are definitely different than what I'm used to because I actually trained the GP knowing the priors. The error bars were reduced which I guess makes sense. </p>
<p><strong>TODO</strong>: Do the MCMC where we approximate the posterior when we trained the GP with uncertain inputs.</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Posterior Approximation</label><div class="tabbed-content"></div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Training</label><div class="tabbed-content">
<div class="tabbed-set" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Exact</label><div class="tabbed-content">
<p><img alt="png" src="../pics/output_10_1.png" /></p>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Prior</label><div class="tabbed-content">
<p><img alt="png" src="../pics/1d_square_prior.png" /></p>
</div>
<input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><label for="__tabbed_2_3">Known Input Error</label><div class="tabbed-content">
<p><img alt="png" src="../pics/output_19_1.png" /></p>
</div>
</div>
</div>
</div>
</div>
<hr />
<h2 id="experiment">Experiment<a class="headerlink" href="#experiment" title="Permanent link">&para;</a></h2>
<details class="details"><summary>Code Blocks</summary><div class="tabbed-set" data-tabs="3:3"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><label for="__tabbed_3_1">Install</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">jax</span> <span class="n">jaxlib</span> <span class="n">numpyro</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Requirement already satisfied: jax in /usr/local/lib/python3.6/dist-packages (0.1.62)
Requirement already satisfied: jaxlib in /usr/local/lib/python3.6/dist-packages (0.1.42)
Collecting numpyro
[?25l  Downloading https://files.pythonhosted.org/packages/b8/58/54e914bb6d8ee9196f8dbf28b81057fea81871fc171dbee03b790336d0c5/numpyro-0.2.4-py3-none-any.whl (159kB)
[K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 163kB 2.5MB/s 
[?25hRequirement already satisfied: absl-py in /usr/local/lib/python3.6/dist-packages (from jax) (0.9.0)
Requirement already satisfied: opt-einsum in /usr/local/lib/python3.6/dist-packages (from jax) (3.2.1)
Requirement already satisfied: numpy&gt;=1.12 in /usr/local/lib/python3.6/dist-packages (from jax) (1.18.3)
Requirement already satisfied: scipy in /usr/local/lib/python3.6/dist-packages (from jaxlib) (1.4.1)
Requirement already satisfied: tqdm in /usr/local/lib/python3.6/dist-packages (from numpyro) (4.38.0)
Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from absl-py-&gt;jax) (1.12.0)
[31mERROR: numpyro 0.2.4 has requirement jax==0.1.57, but you&#39;ll have jax 0.1.62 which is incompatible.[0m
[31mERROR: numpyro 0.2.4 has requirement jaxlib==0.1.37, but you&#39;ll have jaxlib 0.1.42 which is incompatible.[0m
Installing collected packages: numpyro
Successfully installed numpyro-0.2.4
</code></pre></div>


</div>
<input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><label for="__tabbed_3_2">Imports</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">#@title packages</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">onp</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="kn">import</span> <span class="nn">jax</span>
<span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">vmap</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">jax.random</span> <span class="k">as</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">numpyro</span>
<span class="kn">import</span> <span class="nn">numpyro.distributions</span> <span class="k">as</span> <span class="nn">dist</span>
<span class="kn">from</span> <span class="nn">numpyro.infer</span> <span class="kn">import</span> <span class="n">MCMC</span><span class="p">,</span> <span class="n">NUTS</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">reset_defaults</span><span class="p">()</span>
<span class="c1">#sns.set_style(&#39;whitegrid&#39;)</span>
<span class="c1">#sns.set_context(&#39;talk&#39;)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s1">&#39;talk&#39;</span><span class="p">,</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div>

</div>
<input id="__tabbed_3_3" name="__tabbed_3" type="radio" /><label for="__tabbed_3_3">Data</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="c1">#@title Data</span>

<span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">sigma_inputs</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">sigma_obs</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">N_test</span><span class="o">=</span><span class="mi">400</span><span class="p">):</span>
    <span class="n">onp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="c1"># Y = X + 0.2 * np.power(X, 3.0) + 0.5 * np.power(0.5 + X, 2.0) * np.sin(4.0 * X)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">1.6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">X</span><span class="p">))</span>
    <span class="n">Y</span> <span class="o">+=</span> <span class="n">sigma_obs</span> <span class="o">*</span> <span class="n">onp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">+=</span> <span class="n">sigma_inputs</span> <span class="o">*</span> <span class="n">onp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">N</span><span class="p">,)</span>
    <span class="k">assert</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">N</span><span class="p">,)</span>

    <span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">N_test</span><span class="p">)</span> 
    <span class="n">X_test</span> <span class="o">+=</span> <span class="n">sigma_inputs</span> <span class="o">*</span> <span class="n">onp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N_test</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_test</span>
</code></pre></div>

</div>
</div>
</details>
<h2 id="gp-model">GP Model<a class="headerlink" href="#gp-model" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1">#@title GP Model</span>

<span class="c1"># squared exponential kernel with diagonal noise term</span>
<span class="k">def</span> <span class="nf">kernel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="mf">1.0e-6</span><span class="p">,</span> <span class="n">include_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">deltaXsq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="n">X</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">Z</span><span class="p">)</span> <span class="o">/</span> <span class="n">length</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">var</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">deltaXsq</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">include_noise</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="p">(</span><span class="n">noise</span> <span class="o">+</span> <span class="n">jitter</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">k</span>

<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">Xmu</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="c1"># set uninformative log-normal priors on our three kernel hyperparameters</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_var&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_noise&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_length&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="c1"># X = numpyro.sample(&quot;X&quot;, dist.Normal(Xmu, 0.15 * np.ones((Xmu.shape[0],))))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">Xmu</span>

    <span class="c1"># compute kernel</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>

    <span class="c1"># sample Y according to the standard gaussian process formula</span>
    <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">covariance_matrix</span><span class="o">=</span><span class="n">k</span><span class="p">),</span>
                   <span class="n">obs</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="c1"># helper function for doing hmc inference</span>
<span class="k">def</span> <span class="nf">run_inference</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">NUTS</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">mcmc</span> <span class="o">=</span> <span class="n">MCMC</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">num_warmup</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">num_chains</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">num_chains</span><span class="p">,</span>
                <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">mcmc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">mcmc</span><span class="o">.</span><span class="n">print_summary</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">MCMC elapsed time:&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mcmc</span><span class="o">.</span><span class="n">get_samples</span><span class="p">()</span>


<span class="c1"># do GP prediction for a given set of hyperparameters. this makes use of the well-known</span>
<span class="c1"># formula for gaussian process predictions</span>
<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">):</span>
    <span class="c1"># compute kernels between train and test data, etc.</span>
    <span class="n">k_pp</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">include_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">k_pX</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">include_noise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">k_XX</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">,</span> <span class="n">include_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">K_xx_inv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">k_XX</span><span class="p">)</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">k_pp</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">k_pX</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">K_xx_inv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">k_pX</span><span class="p">)))</span>
    <span class="n">sigma_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">a_min</span><span class="o">=</span><span class="mf">0.</span><span class="p">))</span> <span class="o">*</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">k_pX</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">K_xx_inv</span><span class="p">,</span> <span class="n">Y</span><span class="p">))</span>
    <span class="c1"># we return both the mean function and a sample from the posterior predictive for the</span>
    <span class="c1"># given set of hyperparameters</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">mean</span> <span class="o">+</span> <span class="n">sigma_noise</span>
</code></pre></div>

<h3 id="experiment_1">Experiment<a class="headerlink" href="#experiment_1" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">args</span><span class="p">:</span>
    <span class="n">num_data</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">num_warmup</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">num_chains</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1_000</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span>
    <span class="n">sigma_inputs</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">sigma_obs</span> <span class="o">=</span> <span class="mf">0.05</span>

<span class="n">numpyro</span><span class="o">.</span><span class="n">set_platform</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">num_data</span><span class="p">,</span> <span class="n">sigma_inputs</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">sigma_inputs</span><span class="p">,</span> <span class="n">sigma_obs</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">sigma_obs</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">rng_key</span><span class="p">,</span> <span class="n">rng_key_predict</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Run inference scheme</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">run_inference</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>sample: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1100/1100 [00:11&lt;00:00, 96.81it/s, 7 steps of size 6.48e-01. acc. prob=0.94]



                     mean       std    median      5.0%     95.0%     n_eff     r_hat
  kernel_length      1.97      0.23      1.97      1.58      2.34    650.87      1.00
   kernel_noise      0.04      0.01      0.04      0.02      0.05    637.46      1.00
     kernel_var      1.15      0.65      0.98      0.34      1.97    563.69      1.00

Number of divergences: 0

MCMC elapsed time: 14.073462963104248
</code></pre></div>


<h4 id="predictions">Predictions<a class="headerlink" href="#predictions" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># do prediction</span>
<span class="n">vmap_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rng_key_predict</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">*</span> <span class="n">args</span><span class="o">.</span><span class="n">num_chains</span><span class="p">),</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_var&#39;</span><span class="p">],</span>
                <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_length&#39;</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_noise&#39;</span><span class="p">])</span>
<span class="n">means</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span>
                            <span class="n">predict</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">))(</span><span class="o">*</span><span class="n">vmap_args</span><span class="p">)</span>

<span class="n">mean_prediction</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">95.0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># make plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># plot training data</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">)</span>
<span class="c1"># plot 90% confidence level of predictions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">percentiles</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="c1"># plot mean prediction</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">mean_prediction</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mean predictions with 90% CI&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>[Text(0, 0.5, &#39;Y&#39;),
 Text(0.5, 0, &#39;X&#39;),
 Text(0.5, 1.0, &#39;Mean predictions with 90% CI&#39;)]
</code></pre></div>


<p><center></p>
<p><img alt="png" src="../pics/output_10_1.png" /></p>
<p></center></p>
<h2 id="gp-model-uncertain-inputs">GP Model - Uncertain Inputs<a class="headerlink" href="#gp-model-uncertain-inputs" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">emodel</span><span class="p">(</span><span class="n">Xmu</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="c1"># set uninformative log-normal priors on our three kernel hyperparameters</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_var&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_noise&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_length&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="n">Xmu</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="p">)</span>
    <span class="c1"># X = Xmu + Xstd</span>
    <span class="c1"># X = numpyro.sample(&quot;X&quot;, dist.Normal(Xmu, 0.3 * np.ones(Xmu.shape[-1])), )</span>


    <span class="c1"># compute kernel</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>

    <span class="c1"># sample Y according to the standard gaussian process formula</span>
    <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">covariance_matrix</span><span class="o">=</span><span class="n">k</span><span class="p">),</span>
                   <span class="n">obs</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">rng_key</span><span class="p">,</span> <span class="n">rng_key_predict</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Run inference scheme</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">run_inference</span><span class="p">(</span><span class="n">emodel</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>sample: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1100/1100 [00:19&lt;00:00, 56.73it/s, 15 steps of size 2.14e-01. acc. prob=0.93]



                     mean       std    median      5.0%     95.0%     n_eff     r_hat
           X[0]    -10.01      0.25     -9.98    -10.40     -9.59    597.56      1.00
           X[1]     -9.91      0.27     -9.92    -10.30     -9.45    887.43      1.00
           X[2]     -9.65      0.27     -9.67    -10.03     -9.16    475.77      1.00
           X[3]     -9.40      0.25     -9.41     -9.85     -9.04    937.07      1.00
           X[4]     -8.83      0.23     -8.83     -9.27     -8.51    759.05      1.00
           X[5]     -8.33      0.19     -8.31     -8.61     -8.01    463.77      1.00
           X[6]     -8.31      0.19     -8.30     -8.60     -8.01    556.40      1.00
           X[7]     -7.77      0.13     -7.77     -7.98     -7.57    554.29      1.00
           X[8]     -7.42      0.12     -7.42     -7.62     -7.23    426.67      1.00
           X[9]     -7.03      0.11     -7.03     -7.21     -6.84    363.45      1.00
          X[10]     -6.60      0.12     -6.61     -6.79     -6.41    370.03      1.00
          X[11]     -6.29      0.13     -6.29     -6.51     -6.10    423.12      1.00
          X[12]     -5.80      0.16     -5.80     -6.05     -5.54    461.56      1.00
          X[13]     -5.45      0.18     -5.46     -5.74     -5.15    665.71      1.00
          X[14]     -5.00      0.25     -5.02     -5.41     -4.61   1038.74      1.00
          X[15]     -4.97      0.23     -4.98     -5.32     -4.59    782.89      1.00
          X[16]     -4.92      0.32     -4.93     -5.42     -4.40   1370.20      1.00
          X[17]     -4.41      0.29     -4.41     -4.87     -3.91   1293.31      1.00
          X[18]     -4.00      0.31     -3.99     -4.49     -3.50   1020.15      1.00
          X[19]     -3.57      0.28     -3.55     -4.06     -3.14    686.66      1.00
          X[20]     -3.42      0.36     -3.40     -3.96     -2.79    798.33      1.00
          X[21]     -2.57      0.36     -2.57     -3.12     -1.96    760.66      1.00
          X[22]     -2.34      0.28     -2.32     -2.82     -1.92    800.18      1.00
          X[23]     -2.68      0.27     -2.66     -3.07     -2.18    779.41      1.00
          X[24]     -1.61      0.16     -1.61     -1.89     -1.38    410.05      1.01
          X[25]     -1.65      0.16     -1.65     -1.91     -1.38    460.06      1.00
          X[26]     -1.16      0.13     -1.16     -1.36     -0.96    352.57      1.01
          X[27]     -0.81      0.12     -0.80     -0.98     -0.59    363.98      1.01
          X[28]     -0.32      0.12     -0.33     -0.51     -0.13    388.07      1.01
          X[29]      0.11      0.12      0.10     -0.10      0.29    393.42      1.02
          X[30]      0.41      0.13      0.40      0.18      0.62    534.79      1.01
          X[31]      0.93      0.19      0.92      0.63      1.24    897.67      1.00
          X[32]      1.08      0.21      1.07      0.75      1.42    398.94      1.00
          X[33]      1.39      0.33      1.36      0.87      1.90    443.17      1.00
          X[34]      1.67      0.28      1.67      1.25      2.13    822.54      1.00
          X[35]      2.07      0.30      2.07      1.60      2.55    735.84      1.00
          X[36]      2.18      0.30      2.18      1.69      2.65    546.85      1.00
          X[37]      3.10      0.31      3.10      2.63      3.64   1153.64      1.00
          X[38]      2.92      0.28      2.93      2.46      3.35   1498.27      1.00
          X[39]      3.33      0.30      3.34      2.82      3.79   1393.60      1.00
          X[40]      4.02      0.26      4.03      3.64      4.48    743.00      1.00
          X[41]      3.50      0.31      3.50      3.01      3.99    895.25      1.00
          X[42]      3.93      0.33      3.96      3.41      4.47    667.17      1.00
          X[43]      4.27      0.19      4.27      3.96      4.60    626.95      1.00
          X[44]      4.89      0.16      4.88      4.62      5.14    340.23      1.00
          X[45]      5.36      0.13      5.36      5.17      5.58    373.83      1.00
          X[46]      5.78      0.12      5.78      5.58      5.96    307.39      1.00
          X[47]      6.05      0.12      6.06      5.86      6.24    329.60      1.00
          X[48]      6.65      0.13      6.64      6.45      6.86    343.38      1.00
          X[49]      6.94      0.15      6.94      6.68      7.18    385.53      1.00
          X[50]      7.56      0.26      7.53      7.18      8.04    551.86      1.00
          X[51]      7.61      0.26      7.59      7.17      8.03    524.45      1.00
          X[52]      7.63      0.21      7.63      7.25      7.95   1001.54      1.00
          X[53]      8.40      0.30      8.38      7.91      8.89    576.53      1.00
          X[54]      8.28      0.33      8.32      7.69      8.78   1210.06      1.00
          X[55]      8.95      0.26      8.95      8.50      9.34   1332.43      1.00
          X[56]      9.25      0.27      9.25      8.77      9.65   1931.84      1.00
          X[57]      9.27      0.27      9.28      8.82      9.69   1255.06      1.00
          X[58]      9.89      0.28      9.91      9.46     10.36    613.94      1.00
          X[59]     10.22      0.28     10.20      9.78     10.66    925.47      1.00
  kernel_length      1.95      0.19      1.96      1.63      2.23    440.62      1.01
   kernel_noise      0.00      0.00      0.00      0.00      0.01    222.75      1.00
     kernel_var      1.18      0.64      1.02      0.39      2.01    423.49      1.01

Number of divergences: 0

MCMC elapsed time: 23.19466996192932
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="c1"># do prediction</span>
<span class="n">vmap_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rng_key_predict</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">*</span> <span class="n">args</span><span class="o">.</span><span class="n">num_chains</span><span class="p">),</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_var&#39;</span><span class="p">],</span>
                <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_length&#39;</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_noise&#39;</span><span class="p">])</span>
<span class="n">means</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span>
                            <span class="n">predict</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">))(</span><span class="o">*</span><span class="n">vmap_args</span><span class="p">)</span>

<span class="n">mean_prediction</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">95.0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># make plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># plot training data</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">)</span>
<span class="c1"># plot 90% confidence level of predictions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">percentiles</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="c1"># plot mean prediction</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">mean_prediction</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mean predictions with 90% CI&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>[Text(0, 0.5, &#39;Y&#39;),
 Text(0.5, 0, &#39;X&#39;),
 Text(0.5, 1.0, &#39;Mean predictions with 90% CI&#39;)]
</code></pre></div>


<p><center></p>
<p><img alt="png" src="../pics/output_15_1.png" /></p>
<p></center></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">emodel</span><span class="p">(</span><span class="n">Xmu</span><span class="p">,</span> <span class="n">Y</span><span class="p">):</span>
    <span class="c1"># set uninformative log-normal priors on our three kernel hyperparameters</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_var&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_noise&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;kernel_length&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">LogNormal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">))</span>
    <span class="c1"># X = numpyro.sample(&quot;X&quot;, dist.Normal(Xmu, 0.15), )</span>
    <span class="n">Xstd</span> <span class="o">=</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;Xstd&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span> <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="n">Xmu</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">Xmu</span> <span class="o">+</span> <span class="n">Xstd</span>
    <span class="c1"># X = numpyro.sample(&quot;X&quot;, dist.Normal(Xmu, 0.3 * np.ones(Xmu.shape[-1])), )</span>


    <span class="c1"># compute kernel</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">)</span>

    <span class="c1"># sample Y according to the standard gaussian process formula</span>
    <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">covariance_matrix</span><span class="o">=</span><span class="n">k</span><span class="p">),</span>
                   <span class="n">obs</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">rng_key</span><span class="p">,</span> <span class="n">rng_key_predict</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Run inference scheme</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">run_inference</span><span class="p">(</span><span class="n">emodel</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>sample: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1100/1100 [00:17&lt;00:00, 62.81it/s, 15 steps of size 2.65e-01. acc. prob=0.89]



                     mean       std    median      5.0%     95.0%     n_eff     r_hat
        Xstd[0]      0.20      0.26      0.22     -0.23      0.62    792.72      1.00
        Xstd[1]     -0.15      0.26     -0.15     -0.63      0.22    951.20      1.00
        Xstd[2]     -0.09      0.26     -0.11     -0.50      0.37    832.81      1.00
        Xstd[3]      0.10      0.24      0.10     -0.28      0.49    982.06      1.00
        Xstd[4]     -0.25      0.22     -0.26     -0.63      0.09    934.13      1.00
        Xstd[5]      0.09      0.19      0.11     -0.19      0.42    531.47      1.00
        Xstd[6]      0.13      0.18      0.15     -0.18      0.43    452.94      1.00
        Xstd[7]     -0.28      0.13     -0.28     -0.49     -0.06    495.33      1.00
        Xstd[8]      0.14      0.13      0.15     -0.05      0.35    365.29      1.00
        Xstd[9]     -0.10      0.12     -0.10     -0.30      0.09    306.55      1.00
       Xstd[10]     -0.21      0.12     -0.20     -0.42     -0.02    304.69      1.00
       Xstd[11]     -0.05      0.13     -0.05     -0.26      0.18    284.53      1.00
       Xstd[12]     -0.21      0.17     -0.21     -0.49      0.05    415.29      1.00
       Xstd[13]      0.52      0.19      0.50      0.20      0.81    540.49      1.00
       Xstd[14]      0.12      0.24      0.11     -0.29      0.47    898.49      1.01
       Xstd[15]      0.15      0.23      0.14     -0.23      0.52   1165.26      1.00
       Xstd[16]     -0.08      0.33     -0.10     -0.60      0.44    904.75      1.00
       Xstd[17]     -0.00      0.29     -0.00     -0.53      0.43   1652.78      1.00
       Xstd[18]     -0.01      0.32      0.00     -0.49      0.54   1462.54      1.00
       Xstd[19]     -0.02      0.28     -0.01     -0.47      0.47    903.68      1.00
       Xstd[20]      0.14      0.36      0.17     -0.47      0.66    905.66      1.00
       Xstd[21]      0.05      0.36      0.06     -0.54      0.61    648.84      1.00
       Xstd[22]      0.04      0.30      0.07     -0.44      0.51   1011.25      1.00
       Xstd[23]     -0.01      0.27      0.00     -0.43      0.45   1237.85      1.00
       Xstd[24]     -0.20      0.16     -0.20     -0.45      0.06    419.10      1.00
       Xstd[25]     -0.69      0.16     -0.68     -0.98     -0.46    379.36      1.00
       Xstd[26]     -0.33      0.13     -0.33     -0.54     -0.12    320.10      1.00
       Xstd[27]      0.09      0.13      0.09     -0.10      0.30    245.93      1.01
       Xstd[28]      0.50      0.13      0.50      0.30      0.71    253.37      1.01
       Xstd[29]     -0.04      0.13     -0.04     -0.24      0.18    259.11      1.01
       Xstd[30]      0.36      0.14      0.36      0.13      0.57    296.81      1.01
       Xstd[31]      0.07      0.19      0.06     -0.23      0.37    539.63      1.00
       Xstd[32]      0.18      0.21      0.17     -0.18      0.50    868.61      1.00
       Xstd[33]     -0.09      0.31     -0.14     -0.54      0.45    551.52      1.00
       Xstd[34]      0.04      0.27      0.04     -0.35      0.53   1343.46      1.00
       Xstd[35]     -0.01      0.29     -0.01     -0.48      0.51   1573.42      1.00
       Xstd[36]     -0.04      0.29     -0.04     -0.51      0.44   1578.87      1.00
       Xstd[37]      0.02      0.31      0.03     -0.48      0.53   2398.18      1.00
       Xstd[38]     -0.00      0.29     -0.00     -0.45      0.47   1411.13      1.00
       Xstd[39]     -0.01      0.30     -0.01     -0.49      0.48   2119.89      1.00
       Xstd[40]     -0.11      0.25     -0.10     -0.49      0.33    537.76      1.00
       Xstd[41]      0.00      0.30      0.01     -0.48      0.51    934.64      1.00
       Xstd[42]      0.09      0.32      0.12     -0.49      0.55   1000.19      1.00
       Xstd[43]     -0.61      0.20     -0.60     -0.92     -0.28    716.21      1.00
       Xstd[44]      0.31      0.15      0.32      0.08      0.57    487.44      1.00
       Xstd[45]     -0.49      0.12     -0.48     -0.68     -0.28    426.20      1.00
       Xstd[46]      0.30      0.12      0.30      0.11      0.49    383.15      1.00
       Xstd[47]      0.34      0.12      0.34      0.15      0.53    329.32      1.00
       Xstd[48]     -0.21      0.13     -0.22     -0.41     -0.01    383.74      1.00
       Xstd[49]     -0.12      0.15     -0.13     -0.37      0.10    392.93      1.00
       Xstd[50]      0.03      0.25      0.01     -0.37      0.40    668.25      1.00
       Xstd[51]      0.05      0.25      0.03     -0.37      0.46    928.56      1.00
       Xstd[52]      0.26      0.22      0.24     -0.12      0.60    776.53      1.00
       Xstd[53]     -0.14      0.33     -0.17     -0.62      0.48    672.39      1.00
       Xstd[54]      0.06      0.32      0.08     -0.49      0.54   1436.10      1.00
       Xstd[55]      0.06      0.26      0.05     -0.35      0.49   1649.02      1.00
       Xstd[56]     -0.02      0.29     -0.02     -0.47      0.44   1683.10      1.00
       Xstd[57]     -0.01      0.27     -0.01     -0.42      0.48   1384.29      1.00
       Xstd[58]      0.05      0.28      0.06     -0.37      0.54   1061.70      1.00
       Xstd[59]     -0.06      0.26     -0.08     -0.46      0.39   1705.82      1.00
  kernel_length      1.93      0.21      1.94      1.57      2.26    224.70      1.01
   kernel_noise      0.00      0.00      0.00      0.00      0.01    262.87      1.00
     kernel_var      1.15      0.62      1.00      0.41      1.95    344.59      1.00

Number of divergences: 0

MCMC elapsed time: 19.7586088180542
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="c1"># do prediction</span>
<span class="n">vmap_args</span> <span class="o">=</span> <span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rng_key_predict</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">num_samples</span> <span class="o">*</span> <span class="n">args</span><span class="o">.</span><span class="n">num_chains</span><span class="p">),</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_var&#39;</span><span class="p">],</span>
                <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_length&#39;</span><span class="p">],</span> <span class="n">samples</span><span class="p">[</span><span class="s1">&#39;kernel_noise&#39;</span><span class="p">])</span>
<span class="n">means</span><span class="p">,</span> <span class="n">predictions</span> <span class="o">=</span> <span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span>
                            <span class="n">predict</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">noise</span><span class="p">))(</span><span class="o">*</span><span class="n">vmap_args</span><span class="p">)</span>

<span class="n">mean_prediction</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="n">onp</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">95.0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># make plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># plot training data</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;kx&#39;</span><span class="p">)</span>
<span class="c1"># plot 90% confidence level of predictions</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">percentiles</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">percentiles</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="c1"># plot mean prediction</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">mean_prediction</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Mean predictions with 90% CI&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>[Text(0, 0.5, &#39;Y&#39;),
 Text(0.5, 0, &#39;X&#39;),
 Text(0.5, 1.0, &#39;Mean predictions with 90% CI&#39;)]
</code></pre></div>


<p><center></p>
<p><img alt="png" src="../pics/output_19_1.png" /></p>
<p></center></p>
<h2 id="results">Results<a class="headerlink" href="#results" title="Permanent link">&para;</a></h2>
<div class="tabbed-set" data-tabs="4:3"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><label for="__tabbed_4_1">Exact</label><div class="tabbed-content">
<p><img alt="png" src="../pics/output_10_1.png" /></p>
</div>
<input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><label for="__tabbed_4_2">Known Input Error</label><div class="tabbed-content">
<p><img alt="png" src="../pics/output_19_1.png" /></p>
</div>
<input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><label for="__tabbed_4_3">Prior</label><div class="tabbed-content">
<p><img alt="png" src="../pics/1d_square_prior.png" /></p>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../.." title="Input Uncertainty for Gaussian Processes" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Input Uncertainty for Gaussian Processes
              </div>
            </div>
          </a>
        
        
          <a href="../../Notes/approximate/" title="Gaussian Approximations" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Gaussian Approximations
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 J. Emmanuel Johnson
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/jejjohnson" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://twitter.com/jejjohnson" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://linkedin.com/in/jejjohnson" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="https://jejjohnson.netlify.com" target="_blank" rel="noopener" title="jejjohnson.netlify.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.83fe6e3c.min.js"></script>
      <script src="../../assets/javascripts/bundle.7e1cb91c.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>